DELIMITER $$
CREATE PROCEDURE Get_patients()
	SELECT * FROM patient
$$ DELIMITER ;

DELIMITER $$
CREATE PROCEDURE Get_Prescription(IN consult_id_input INT)
SELECT consult_schedule AS 'Time', consult_date AS 'Date', consult_id AS 'Visit id', med_name AS 'Medicine name', instructions 
FROM consult JOIN prescription 
ON consult.prescription_id = prescription.prescription_id 
JOIN prescription_meds ON prescription.prescription_id = prescription_meds.prescription_id 
JOIN meds ON prescription_meds.med_id = meds.med_id
WHERE consult_id_input = consult_id
$$ DELIMITER ;

/* Delete patient 1*/
DELIMITER $$
CREATE PROCEDURE Delete_patient1()
/* 1. Borrar respuestas del paciente de consultas donde el paciente es 1 */
DELETE FROM answer
WHERE instance_id (
	SELECT 
	 ti.instance_id
	FROM consult c
	JOIN test_instance ti
	ON c.consult_id = ti.consult_id
	WHERE c.patient_id = 1
);

/*2.Borrar consultas de test_instance donde el paciente es 1*/
DELETE FROM test_instance
WHERE consult_id IN (
    SELECT 
	 c.consult_id
	FROM consult c
	WHERE c.patient_id = 1
);

/* 3.Borrar de la tabla Detalles_Med */
DELETE FROM recipe
WHERE prescription_id IN
(
SELECT 
	 p.prescription_id
FROM consult c
JOIN prescription p
ON c.prescription_id = p.prescription_id
WHERE c.patient_id = 1);


/* 4.Borrar de la tabla prescription todas las consultas donde el paciente es 1*/
DELETE FROM prescription
WHERE consult_id IN
(
SELECT 
	 c.consult_id
FROM consult c
WHERE c.patient_id = 1
);
/* 5. Borrar consultas del diagnostico donde el paciente es 1*/ 
DELETE FROM diagnostic
WHERE consult_id IN(
SELECT 
	 c.consult_id
FROM consult c
WHERE c.patient_id = 1
);
/* 6. Borrar de la tabla consultas donde el paciente es 1*/
DELETE FROM consult
WHERE patient_id = 1;

/* 7. Borrar de la tabla paciente donde el paciente es 1 */
DELETE FROM patient
WHERE patient_id = 1;
$$ DELIMITER ;

/*
1. Patient Name and diagnosis for all patients "Perez"  (Perez is a parameter)
    Nombre del paciente y nombre del diagnostico para los pacientes Perez
2. Diagnosis Name  and number of times in descending order of times
    Nombre del  diagnostico y numero de veces que se ha diagnosticado, ordenado del mas a menos frecuencia
3. Nombre del paciente y Numero de visitas ordenado por nombre del paciente
    Patient Name and Number of visits ordered by patient name 
4. Display a Anxiety Test
5. Display a Depression Test
6. Display the complete  EHR of a patient ( ADA )
*/



DELIMITER $$
CREATE PROCEDURE(IN first_name_input VARCHAR(20))

$$ DELIMITER ;

DELIMITER $$
CREATE PROCEDURE(IN first_name_input VARCHAR(20))

$$ DELIMITER ;

DELIMITER $$
CREATE PROCEDURE(IN first_name_input VARCHAR(20))

$$ DELIMITER ;
